CC          := gcc

WARNINGS ?= -Wall -Wextra -Wshadow -Wpointer-arith -Wcast-align \
            -Wwrite-strings -Wmissing-prototypes -Wmissing-declarations \
            -Wredundant-decls -Wnested-externs -Winline -Wno-long-long \
            -Wuninitialized -Wconversion -Wstrict-prototypes -Werror
			
CFLAGS := -std=c11 -Ofast $(WARNINGS) 

DEBUG := -g3
#CFLAG += -g3

LIBS := -lm

HDRSARR = ./test.h ../src/utils/arrays.h
SRCSARR =  ../src/utils/arrays.c ./test_arrays.c
OBJSARR = $(SRCSARR:.c=.o)

HDRSCSV = ./test.h ../src/utils/csv.h ../src/utils/strings.h
SRCSCSV =  ../src/utils/csv.c ../src/utils/sll.c ./test_csv.c ../src/utils/strings.c
OBJSCSV = $(SRCSCSV:.c=.o)

HDRSSLL = ./test.h ../src/utils/sll.h ../src/utils/strings.h
SRCSSLL =  ../src/utils/sll.c ./test_sll.c ../src/utils/strings.c
OBJSSLL = $(SRCSSLL:.c=.o)

HDRSGRAV = ./test.h ../src/utils/sll.h ../src/gravimetry.h ../src/utils/csv.h ../src/utils/strings.h ./src/utils/calcs.h
SRCSGRAV =  ../src/utils/sll.c ../src/gravimetry.c ../src/utils/csv.c ./test_gravimetry.c ../src/utils/strings.c ../src/utils/calcs.c
OBJSGRAV = $(SRCSGRAV:.c=.o)

HDRSSTR = ./test.h ../src/utils/strings.h
SRCSSTR =  ../src/utils/strings.c ./test_strings.c
OBJSSTR = $(SRCSSTR:.c=.o)

HDRSCALCS = ./test.h ../src/utils/calcs.h
SRCSCALCS =  ../src/utils/calcs.c ./test_calcs.c
OBJSCALCS = $(SRCSCALCS:.c=.o)

all:
	make test_array
	make test_csv
	make test_sll
	make test_grav
	make test_strings
	make test_calcs
	make clean

test:
	./test_array
	./test_csv
	./test_sll
	./test_strings
	./test_grav
	
test_array: $(OBJSARR) $(HDRSARR) Makefile
	$(CC) $(CFLAGS) -o $@ $(OBJSARR) $(LIBS)
	
test_csv: $(OBJSCSV) $(HDRSCSV) Makefile
	$(CC) $(CFLAGS) -o $@ $(OBJSCSV) $(LIBS)
	
test_sll: $(OBJSSLL) $(HDRSSLL) Makefile
	$(CC) $(CFLAGS) -o $@ $(OBJSSLL) $(LIBS)
	
test_grav: $(OBJSGRAV) $(HDRSGRAV) Makefile
	$(CC) $(CFLAGS) -o $@ $(OBJSGRAV) $(LIBS)
	
test_strings: $(OBJSSTR) $(HDRSSTR) Makefile
	$(CC) $(CFLAGS) -o $@ $(OBJSSTR) $(LIBS)

test_calcs: $(OBJSCALCS) $(HDRSCALCS) Makefile
	$(CC) $(CFLAGS) -o $@ $(OBJSCALCS) $(LIBS)
	
.PHONY: clean
clean:
	rm -f core $(EXE) *.o
	rm -rf ../src/*.o ../src/utils/*.o
	
.PHONY: purge
purge:
	rm -f core $(EXE) *.o
	rm -rf ../src/*.o ../src/utils/*.o ./test_array ./test_csv ./test_csv ./test_sll ./test_grav ./test_strings
